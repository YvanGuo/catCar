C51 COMPILER V9.56.0.0   SERVOCOMMON                                                       03/16/2019 17:07:35 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE SERVOCOMMON
OBJECT MODULE PLACED IN .\list\servoCommon.obj
COMPILER INVOKED BY: E:\keil_c51\C51\BIN\C51.EXE hal\servoCommon.c LARGE OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRI
                    -NT(.\list\servoCommon.lst) TABS(2) OBJECT(.\list\servoCommon.obj)

line level    source

   1          
   2          #include "servoCommon.h"
   3          #include "pinCtl.h"
   4          #include "driver/51/hw_pwm.h"
   5          #include "timer.h"
   6          
   7          typedef struct s_ServoCfg{
   8              int16 pin;
   9              uint16 minPW;
  10              uint16 maxPW;
  11              int16 minAngle;
  12              int16 maxAngle;
  13          }s_ServoCfg;
  14          
  15          static s_ServoCfg G_ServoCfg;
  16          
  17          static void resetFields(void)
  18          {
  19   1        resetServoPulCnt();
  20   1      }
  21          
  22          uint16 servoReadMicroseconds()
  23          {
  24   1        
  25   1        return 0;
  26   1      }
  27          
  28          void servoWriteMicroseconds(uint16 pulseWidth)
  29          {
  30   1        
  31   1        setServoPulseWidth(pulseWidth);
  32   1        
  33   1      }
  34          
  35          int32 servoRead()
  36          {
  37   1        
  38   1        return 0;
  39   1      }
  40          
  41          
  42          void servoWrite(int32 angle)
  43          {
  44   1        
  45   1        setServoPulseWidth(pulseWidth);
*** ERROR C202 IN LINE 45 OF hal\servoCommon.c: 'pulseWidth': undefined identifier
  46   1      }
  47          
  48          int8 servoDetach()
  49          {
  50   1        pinMode_common(G_ServoCfg.pin, OUTPUT);
  51   1        G_ServoCfg.pin = NOT_ATTACHED;
  52   1        return 0;
  53   1      }
C51 COMPILER V9.56.0.0   SERVOCOMMON                                                       03/16/2019 17:07:35 PAGE 2   

  54          
  55          int32 servoAttachedPin()
  56          { 
  57   1        return G_ServoCfg.pin; 
  58   1        
  59   1      }
  60          
  61          int16 servoAttached()
  62          { 
  63   1        return G_ServoCfg.pin != NOT_ATTACHED; 
  64   1      }
  65          
  66          int8 servoAttach(uint8 pin, uint16 minPulseWidth, uint16 maxPulseWidth, int16 minAngle, int16 maxAngle)
  67          {
  68   1        if(servoAttached()){
  69   2        
  70   2          return 0;
  71   2        }
  72   1        
  73   1        G_ServoCfg.pin = pin;
  74   1        G_ServoCfg.minPW = minPulseWidth;
  75   1        G_ServoCfg.maxPW = maxPulseWidth;
  76   1        G_ServoCfg.minAngle = minAngle;
  77   1        G_ServoCfg.maxAngle = maxAngle;
  78   1        pinMode_common(pin, PWM);
  79   1        registTimerCbFun(TIMER_0, ServoPwmInterruptProc);
  80   1        return 0;
  81   1      }
  82          
  83          void ServoDefaultInit()
  84          {
  85   1        if(servoAttached()){
  86   2        
  87   2          return;
  88   2        }
  89   1        
  90   1        G_ServoCfg.pin = SERVO_CTL_PIN;
  91   1        G_ServoCfg.minPW = SERVO_DEFAULT_MIN_PW;
  92   1        G_ServoCfg.maxPW = SERVO_DEFAULT_MAX_PW;
  93   1        G_ServoCfg.minAngle = SERVO_DEFAULT_MIN_ANGLE;
  94   1        G_ServoCfg.maxAngle = SERVO_DEFAULT_MAX_ANGLE;
  95   1        pinMode_common(G_ServoCfg.pin, PWM);
  96   1        registTimerCbFun(TIMER_0, ServoPwmInterruptProc);
  97   1      }

C51 COMPILATION COMPLETE.  0 WARNING(S),  1 ERROR(S)
